# BarqNet Endnode Server Configuration
# Endnodes communicate with Management API ONLY - no direct database access needed

# ============================================================
# SECURITY CONFIGURATION (CRITICAL)
# ============================================================

# JWT Secret - MUST match Management Server's JWT_SECRET
# This is used to validate tokens issued by Management Server
# SECURITY: Use a strong random value (minimum 32 characters)
# IMPORTANT: This MUST be the SAME as Management Server's JWT_SECRET
JWT_SECRET=your_jwt_secret_key_here_minimum_32_characters_required

# API Key - For authenticating with Management Server
# SECURITY: Use a strong random value (minimum 16 characters)
# This must be registered with the Management Server
API_KEY=your_api_key_here_min_16_chars

# ============================================================
# MANAGEMENT SERVER CONNECTION (CRITICAL)
# ============================================================

# Management Server API URL
# This is where the endnode will register and sync data
# Examples:
#   - Local development: http://localhost:8085
#   - Production: https://api.barqnet.com
MANAGEMENT_URL=http://localhost:8085

# ============================================================
# REDIS CONFIGURATION (OPTIONAL)
# ============================================================

# Redis is used for caching and rate limiting
# Default values work for local Redis installation

# Redis Host
# Default: localhost
REDIS_HOST=localhost

# Redis Port
# Default: 6379
REDIS_PORT=6379

# Redis Database Number (0-15)
# Default: 0
REDIS_DB=0

# Redis Password (if authentication is enabled)
# Leave empty if Redis has no password
REDIS_PASSWORD=

# ============================================================
# ENDNODE CONFIGURATION
# ============================================================

# Server ID - Unique identifier for this endnode
# Can also be provided via -server-id command line flag
# Example: server-1, us-east-1, eu-west-1
ENDNODE_SERVER_ID=server-1

# Server Port
# Default: 8081 (to avoid conflict with management server on 8085)
# This is the port the endnode API will listen on
PORT=8081

# ============================================================
# NOTES
# ============================================================

# Endnode Architecture:
# - Endnodes do NOT need database credentials (DB_HOST, DB_USER, etc.)
# - They communicate with Management Server via API only
# - This prevents direct database access from distributed endnodes
# - All user data, authentication, and management happens via Management API
#
# What Endnodes DO:
# - Register with Management Server on startup
# - Handle VPN connections (OpenVPN)
# - Route VPN traffic
# - Report statistics to Management Server
#
# What Endnodes DON'T DO:
# - Direct database queries
# - User authentication (validated via JWT from Management)
# - User management (handled by Management Server)

# ============================================================
# QUICK START
# ============================================================

# 1. Copy this file to .env:
#    cp .env.example .env
#
# 2. Update the following CRITICAL variables:
#    - JWT_SECRET (must match Management Server)
#    - API_KEY (register this with Management Server)
#    - MANAGEMENT_URL (your Management Server address)
#
# 3. Build and run:
#    go build -o endnode main.go
#    ./endnode -server-id server-1
#
# 4. Verify registration:
#    Check Management Server logs for registration confirmation

# ============================================================
# SECURITY CHECKLIST
# ============================================================

# Before deploying to production:
# [ ] Generate strong JWT_SECRET (32+ characters, random)
# [ ] Generate strong API_KEY (16+ characters, random)
# [ ] JWT_SECRET matches Management Server exactly
# [ ] API_KEY is registered with Management Server
# [ ] MANAGEMENT_URL uses HTTPS in production
# [ ] Redis password is set (if using Redis)
# [ ] File permissions: chmod 600 .env
